<export>

<div class="w-100 search-box w3-hide Export" style="position:fixed;z-index:8177;top:0;height:0;padding-top:3rem">
  <div style="max-width:400px;margin:auto;">
    <div class="pos-relative">
      <div class="search-box relative">
        <div class="w3-round w3-white d-grid relative" style="z-index:1;grid-template-columns:1fr auto;align-items:center">
          <div class="button-tb ov-hidden">
            <input id="search-input" class="w3-round w3-white w3-padding w-100" autocomplete='off' data-onkeydown="cmd-select-command" data-oninput="cmd-search-command" placeholder='Search snippets' type='text' name='q' style="border:0;padding:16px"/>
          </div>
          <div>
            <label for="search-input">
              <i id="btn-search" class="material-icons ai-button" onclick="resetSearch(this)">search</i>
            </label>
          </div>
        </div>
      </div>
    </div>
    <div id="search-result" class="pos-relative" style="z-index:1;top:-2px;"></div>
  </div>
</div>

<div id="update-notif" class="Export w-100" style="position:fixed;bottom:0;left:0;background:#0b0b0e;color:#ccc;z-index:8177;font-weight:bold">
  <div class="w3-right">
    <div id="btn-refresh" style="padding:16px;text-transform:uppercase;font-weight:bold;color:#d8d782;">Refresh</div>
    <div id="btn-dismiss" style="padding:16px;text-transform:uppercase;font-weight:bold;">Dismiss</div>
  </div>
  <div class="w3-rest">
    <small style="padding:16px;">New version available</small>
  </div>
</div>

<modal-v2 class="modal-component Export" data-name="settings">
  <div class="Modal bg8 col1" slot="content">
    <div class="Header no-select d-flex justify-content-between">
      <h5><b class="title">Settings</b></h5>
      <button class="material-icons toggler close-btn">close</button>
    </div>
    <div class="Content">
      
      <section>
        <h6 style="font-weight:bold;">Preview</h6>
        <p>
          <label><input data-name="divlessHTMLEnabled" class="autofocus w3-check input-settings" type="checkbox"/> Convert Divless HTML format (.html files only)</label>
        </p>
        <p>
          <label><input data-name="linkPreviewWindowProcess" class="autofocus w3-check input-settings" type="checkbox"/> Link preview window process (might freeze editor while in debug mode)</label>
        </p>
        <small>JavaScript (Terser) : </small>
        <p>
          <label><input data-name="minifyJs" class="autofocus w3-check input-settings" type="checkbox"/> Minify</label>
        </p>
      </section>
      <hr/>
      <section>
        <h6 style="font-weight:bold;">File Manager</h6>
        <p>
          <label><input data-name="divlessHTMLFSEnabled" class="autofocus w3-check input-settings" type="checkbox"/> Convert Divless HTML format on file save (.html files only)</label>
        </p>
      </section>
      <hr/>
      <section>
        <h6 style="font-weight:bold;">Editor</h6>
        <p>
          <label><input data-name="emmetEnabled" class="w3-check input-settings" type="checkbox"/> Emmet Support</label>
        </p>
        <p>
          <label><input data-name="autoCompleteEnabled" class="w3-check input-settings" type="checkbox"/> Autocompletion</label>
        </p>
      </section>
      <hr/>
      <section>
        <h6 class="w3-hide" style="font-weight:bold;">Google Drive Sync</h6>
        <p>
        <label><input id="check-auto-sync" class="w3-check" type="checkbox" oninput="ui.toggleAutoSync()" checked/> Automatically sync files and folders</label>          
        </p>
      </section>
      <hr/>

      <!-- work offline -->
      <section>
        <h6 style="font-weight:bold;">Updates & Offline Access</h6>
        <button type="button" class="btn-style-1" style="width:auto" onclick="pwaCacher.update()">Check for updates</button>
        <button type="button" class="btn-style-1" style="width:auto" onclick="pwaCacher.removeUpdate()">Remove App Cache</button>
        <p>*) Removing app cache will disable offline access until you update the app manually by clicking on <b>Check for updates</b> button.</p>
      </section>
      <hr/>

      <section>
        <h6 style="font-weight:bold;">File Storage</h6>
        <p>Delete locally saved files & folders (doesn't affect your files on Google Drive).</p>
        <button class="btn-style-1 clickable toggler" style="width:auto" data-callback="clear-data">Clear data</button>
      </section>
      <hr/>
      <section>
        <h6 style="font-weight:bold;">GitHub Token</h6>
        <p>Set personal access token to get higher rate limit. Valid until this application is closed.</p>
        <p><label><input id="check-save-token" class="w3-check" type="checkbox" oninput="ui.toggleSaveToken()"/> Store token in browser storage</label></p>
        <button class="btn-style-1 clickable" style="width:auto" data-callback="set-git-token">Set token</button>
      </section>
    </div>
  </div>
</modal-v2>

<modal-v2 class="modal-component Export" data-name="snippet-manager">
  <div class="Modal bg8 col1" slot="content">
    <div class="Header no-select d-flex justify-content-between">
      <h5><b class="title">Snippet Manager</b></h5>
      <button class="material-icons toggler close-btn">close</button>
    </div>
    <div class="Content">
      <section>
        <p>
          <i>This feature is still in development.</i>
        </p>
        <p>
          You can manage custom snippets here.
        </p>
      </section>
    </div>
  </div>
</modal-v2>

<modal-v2 class="modal-component Export" data-name="deploy-firebase">
  <div class="Modal bg8 col1" slot="content">
    <div class="Header no-select d-flex justify-content-between">
      <h5><b class="title">Deploy to Firebase Hosting</b></h5>
      <button class="material-icons toggler close-btn">close</button>
    </div>
    <div class="Content">
      <section>
        <div class="unauthorized">You're not logged in. Sign in to use this feature.</div>

        <div class="feature-disabled" data-feature="firebase">
          Access to Firebase account is required.
          <div style="height:1em"></div>
          <button class="clickable btn-style-1 w-100" data-callback="grant-firebase-access">Grant Access</button>
        </div>

        <form class="authorized feature-enabled submittable preventDefault if-post" data-callback="deploy-hosting" data-feature="firebase">
          
          <p>Note : You are deploying current opened directory.</p>
          <small>Manage your project at <a href="https://firebase.google.com/" target="_blank"><u>Firebase</u></a></small>

          <div style="height:1em"></div>
          <small>Select Project</small>
          <select id="project-list" class="inputable" data-callback="select-project" name="projectId"></select>
          <div style="height:1em"></div>
          <div>
            <small class="if-post">Select Site</small>
          </div>
          <select id="site-list" class="inputable" data-callback="select-site" name="siteId"></select>
          <div style="height:1em"></div>
          <div>
            <small class="if-post">Cache-Control</small>
          </div>
          <input type="number" value="0" name="cacheControl"/> seconds

          <!-- deploy options -->
          <div>

            <h4 style="font-weight:bold;">Deploy options</h4>
            
            <!-- firebase js options -->
            <small>JavaScript (Terser) : </small>
            <p>
              <label>
                <input class="autofocus w3-check input-settings" name="minifyJs" type="checkbox"/> 
                Minify
              </label>
            </p>
            <small>CSS (Lighting CSS, transform target : Chrome 95) : </small>
            <mark class="w3-round" style="padding:0 2px 2px ;"><small>Beta</small></mark>
            <p>
              <label>
                <input name="minifyCss" class="autofocus w3-check input-settings" type="checkbox"/> 
                Minify
              </label>
              <label>
                <input name="transformCss" class="autofocus w3-check input-settings" type="checkbox"/> 
                Transform
              </label>
            </p>

          </div>

          <div style="height:1em"></div>
          <button class="btn-style-1">Deploy</button>
          <div style="height:1em"></div>
          <div id="deploy-logs"></div>
        </form>

      </section> 
    </div>
  </div>
</modal-v2>

<modal-v2 class="modal-component Export" data-name="file-download">
  <div class="Modal bg8 col1" slot="content">
    <div class="Header no-select d-flex justify-content-between">
      <h5><b class="title">File Download</b></h5>
      <button class="material-icons toggler close-btn">close</button>
    </div>
    <div class="Content">
      <section>
        <h6 style="font-weight:bold;">Download options</h6>
        <form class="submittable preventDefault" data-callback="confirm-download">
          <p>
            <label class="no-select"><input class="w3-check" name="replaceDivless" type="checkbox"/> Convert Divless-HTML tag</label>
          </p>
          <p class="no-select">
          <!-- <p class="no-select _in-replaceFileTemplate"> -->
            <label class="no-select"><input class="w3-check" name="replaceFileTag" type="checkbox"/> Replace &lt;file> template </label>
          </p>
          <p class="no-select">
            <label class="no-select"><input class="w3-check" name="minifyJs" type="checkbox"/> Try to minify JavaScript files</label>
          </p>
          <div style="text-align:right;">
            <button class="btn-style-1 autofocus" name="submit" style="width:auto">Download</button>
          </div>
        </form>
      </section> 
    </div>
  </div>
</modal-v2>

<modal-v2 class="modal-component Export" data-name="generate-single-file">
  <div class="Modal bg8 col1" slot="content">
    <div class="Header no-select d-flex justify-content-between">
      <h5><b>Generate Single File</b></h5>
      <button class="material-icons toggler close-btn">close</button>
    </div>
    <div class="Content">
      <section>
        <h6 style="font-weight:bold;">File options</h6>

        <form onsubmit="event.preventDefault()">
        
          <div>
            <label class="no-select">
              <input class="w3-check" name="replaceDivless" type="checkbox"/> Convert Divless HTML format
            </label>
          </div>
          <div class="void void-half"></div>
          <small>JavaScript (Terser) : </small>
          <p>
            <label><input name="minifyJs" class="autofocus w3-check input-settings" type="checkbox"/> Minify</label>
          </p>
          <small>CSS (Lighting CSS, transform target : Chrome 95) : </small>
          <mark class="w3-round" style="padding:0 2px 2px ;">
            <small>Beta</small>
          </mark>
          <p>
            <label>
              <input name="minifyCss" class="autofocus w3-check input-settings" type="checkbox"/> 
              Minify
            </label>
            <label>
              <input name="transformCss" class="autofocus w3-check input-settings" type="checkbox"/> 
              Transform
            </label>
            <label>
              <input name="wrapCdata" class="autofocus w3-check input-settings" type="checkbox"/> 
              Wrap in CDATA tags
            </label>
          </p>

          <div class="d-flex justify-content-end mt-1">
            <button class="btn-style-1 clickable toggler autofocus" data-callback="copy-generated-file" name="submit" style="width:auto">
              <i class="material-icons" style="color:white">content_paste</i> 
              <span class="ml-1">Copy</span>
            </button>
            <button class="btn-style-1 ml-2 clickable toggler" data-callback="generate-single-file" name="submit" style="width:auto">
              <i class="material-icons" style="color:white">download</i> 
              <span class="ml-1">Download</span>
            </button>
          </div>

        </form>

      </section>
    </div>
  </div>
</modal-v2>

<modal-v2 class="modal-component Export" data-name="account">
  <div class="Modal bg8 col1" slot="content">
    <div class="Header no-select d-flex justify-content-between">
      <h5><b>My Account</b></h5>
      <button class="material-icons toggler close-btn autofocus">close</button>
    </div>
    <div class="Content">
      <section>
        <p class="w3-small unauthorized">(!) Your files are <b>currently stored locally</b> in browser storage. Sign in to synchronize with Google Drive across devices.</p>
        <div id="g-signin2" class="unauthorized"></div>
        <div class="authorized">
          <button class="btn-style-1 clickable" style="width:auto" data-callback="sign-out">Sign out</button>
        </div>
        <hr/>
        <p class="w3-small">By using <b>Codetmp</b>, you're considered agreed to terms and condition written on articles below :</p>
        <ul>
          <li>
             <u><a target="_blank" href="pages/TOS.html" style="font-weight:bold;">Terms of Service</a></u>
          </li>
          <li>
             <u><a href="pages/PP.html" target="_blank" style="font-weight:bold;">Privacy Policy</a></u>
          </li>
        </ul>
        </section>
    </div>
  </div>
</modal-v2>

<modal-v2 class="modal-component Export" data-name="prompt">
  <div class="Modal bg8 col1" slot="content">
    <div class="Header no-select d-flex justify-content-between">
      <h5><b class="title"></b></h5>
      <button class="material-icons toggler close-btn">close</button>
    </div>
    <div class="Content">
      <form data-type="prompt">
        <section>
          <input type="" name="" class="w3-input autofocus" spellcheck="false">
          <small class="notes"></small>
          <div class="void void-full"></div>
          <div class="text-right no-select">
            <button class="Btn-submit btn-style-1" type="submit" name="submit" ><i class="material-icons">check</i>Ok</button>
            <button type="button" class="toggler btn-style-2"><i class="material-icons">close</i>Cancel</button>
          </div>
        </section>
      </form>
      </div>
    </div>
  </div>
</modal-v2>

<modal-v2 class="modal-component Export" data-name="confirm">
  <div class="Modal bg8 col1" slot="content">
    <div class="Header no-select d-flex justify-content-between">
      <h5><b class="title">Confirm</b></h5>
      <button class="material-icons toggler close-btn">close</button>
    </div>
    <div class="Content">
      <form data-type="confirm">
        <section>
        <p class="message"></p>
        <div class="void void-full"></div>
        <div class="text-right no-select">
          <button class="Btn-submit btn-style-1 autofocus" type="submit" name="submit" ><i class="material-icons">check</i>Ok</button>
          <button type="button" class="toggler btn-cancel btn-style-2"><i class="material-icons">close</i>Cancel</button>
        </div>
        </section>
      </form>
      </div>
    </div>
  </div>
</modal-v2>

</export>

<script>
  let content = document.getElementsByTagName('export')[0].innerHTML.trim();
  window.opener.postMessage({ type: 'export-html', content }, '*');
</script>